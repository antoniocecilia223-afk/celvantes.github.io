<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cervantes | Super App</title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        :root { --gold: #d4af37; --bg: #000; --card: #121212; --text: #fff; --nav: #000; }
        .light-mode { --bg: #f0f2f5; --card: #ffffff; --text: #1c1e21; --nav: #ffffff; }
        
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; transition: 0.3s; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        /* HEADER */
        header { display: flex; justify-content: space-between; align-items: center; padding: 10px 20px; border-bottom: 1px solid #333; background: var(--nav); height: 60px; z-index: 100; }
        .logo { font-size: 1.5rem; font-weight: bold; color: var(--gold); }

        /* APP LAYOUT */
        .wrapper { display: flex; flex: 1; overflow: hidden; }
        nav { width: 70px; border-right: 1px solid #333; display: flex; flex-direction: column; align-items: center; padding-top: 20px; gap: 30px; background: var(--nav); }
        nav i { font-style: normal; font-size: 1.5rem; cursor: pointer; color: #888; }
        nav i.active { color: var(--gold); }

        /* CONTE√öDO */
        main { flex: 1; overflow-y: auto; padding: 20px; position: relative; }
        .section { display: none; max-width: 600px; margin: 0 auto; }
        .active-section { display: block; }

        /* CARD STYLE */
        .card { background: var(--card); border-radius: 12px; border: 1px solid #333; padding: 15px; margin-bottom: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        
        /* CHATS & COMUNIDADES */
        .chat-item { display: flex; align-items: center; gap: 15px; padding: 10px; border-bottom: 1px solid #333; cursor: pointer; }
        .chat-item:hover { background: rgba(212, 175, 55, 0.1); }
        .avatar { width: 50px; height: 50px; border-radius: 50%; background: #333; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .avatar img { width: 100%; height: 100%; object-fit: cover; }

        /* DEFINI√á√ïES */
        .setting-row { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid #333; }
        button { background: var(--gold); border: none; padding: 10px 15px; border-radius: 6px; font-weight: bold; cursor: pointer; }
        .btn-danger { background: #e74c3c; color: white; }

        /* GEST√ÉO DE POSTS */
        .post-manage { display: flex; justify-content: space-between; align-items: flex-start; }
        .del-btn { color: #ff4444; font-size: 0.8rem; cursor: pointer; border: 1px solid #ff4444; padding: 2px 5px; border-radius: 4px; }

        /* INPUTS */
        input, select, textarea { width: 100%; padding: 10px; margin-top: 10px; border-radius: 8px; border: 1px solid #444; background: #000; color: #fff; box-sizing: border-box; }
        .light-mode input, .light-mode select, .light-mode textarea { background: #fff; color: #000; border: 1px solid #ccc; }
    </style>
</head>
<body>

<header>
    <div class="logo">CERVANTES</div>
    <div id="g_id_onload" data-client_id="YOUR_GOOGLE_ID" data-callback="handleLogin"></div>
    <div class="g_id_signin" data-type="standard"></div>
</header>

<div class="wrapper">
    <nav>
        <i class="active" onclick="showTab('home', this)">üè†</i>
        <i onclick="showTab('chats', this)">üí¨</i>
        <i onclick="showTab('create', this)">‚ûï</i>
        <i onclick="showTab('channel', this)">üì∫</i>
        <i onclick="showTab('settings', this)">‚öôÔ∏è</i>
    </nav>

    <main id="main-content">
        <section id="home" class="section active-section">
            <h2>Feed Global</h2>
            <div id="global-feed"></div>
        </section>

        <section id="chats" class="section">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h2>Conversas</h2>
                <button onclick="alert('Criar nova Comunidade...')">üë• Novo Grupo</button>
            </div>
            <div class="chat-item">
                <div class="avatar">ü§ñ</div>
                <div><strong>Comunidade Cervantes IA</strong><br><small>Suporte: Como posso ajudar?</small></div>
            </div>
            <div style="margin-top: 20px; color: #888; font-size: 0.8rem; cursor: pointer;">üìÅ Ver conversas arquivadas</div>
        </section>

        <section id="create" class="section">
            <div class="card">
                <h2>Publicar no Canal</h2>
                <select id="post-type">
                    <option value="video">V√≠deo / Reel</option>
                    <option value="foto">Foto</option>
                    <option value="texto">Texto / Pensamento</option>
                    <option value="historia">Hist√≥ria (24h)</option>
                </select>
                <textarea id="post-content" rows="4" placeholder="Escreve algo..."></textarea>
                <input type="file" id="post-file">
                <button onclick="publicar()" style="width: 100%; margin-top: 10px;">PUBLICAR</button>
            </div>
        </section>

        <section id="channel" class="section">
            <div class="card" style="text-align: center;">
                <div class="avatar" style="width: 80px; height: 80px; margin: 0 auto; border: 2px solid var(--gold);">
                    <img id="profile-pic" src="https://via.placeholder.com/150" alt="Perfil">
                </div>
                <h3 id="profile-name">O Teu Canal</h3>
                <input type="file" id="change-pic" style="display: none;" onchange="updateProfilePic(this)">
                <button onclick="document.getElementById('change-pic').click()" style="font-size: 0.7rem;">Mudar Foto de Perfil</button>
            </div>
            <h4>As tuas publica√ß√µes</h4>
            <div id="my-posts-list"></div>
        </section>

        <section id="settings" class="section">
            <h2>Defini√ß√µes</h2>
            <div class="card">
                <div class="setting-row">
                    <span>Modo de Visualiza√ß√£o</span>
                    <button onclick="toggleTheme()">Trocar Modo</button>
                </div>
                <div class="setting-row">
                    <span>L√≠ngua do Sistema</span>
                    <select style="width: auto;" onchange="alert('L√≠ngua alterada!')">
                        <option>Portugu√™s</option>
                        <option>English</option>
                        <option>Fran√ßais</option>
                    </select>
                </div>
                <div class="setting-row">
                    <span>Gest√£o de Conta</span>
                    <button onclick="alert('Redirecionando para Google Account...')">Privacidade</button>
                </div>
                <button class="btn-danger" style="width: 100%; margin-top: 20px;" onclick="location.reload()">Terminar Sess√£o</button>
            </div>
        </section>
    </main>
</div>

<script>
    let posts = JSON.parse(localStorage.getItem('cervantes_posts') || '[]');

    function showTab(tabId, el) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active-section'));
        document.querySelectorAll('nav i').forEach(i => i.classList.remove('active'));
        document.getElementById(tabId).classList.add('active-section');
        el.classList.add('active');
    }

    function toggleTheme() {
        document.body.classList.toggle('light-mode');
    }

    function updateProfilePic(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = e => document.getElementById('profile-pic').src = e.target.result;
            reader.readAsDataURL(input.files[0]);
        }
    }

    function publicar() {
        const type = document.getElementById('post-type').value;
        const content = document.getElementById('post-content').value;
        if(!content && type === 'texto') return alert("Escreve alguma coisa!");

        const newPost = {
            id: Date.now(),
            type,
            content,
            date: new Date().toLocaleString()
        };

        posts.unshift(newPost);
        localStorage.setItem('cervantes_posts', JSON.stringify(posts));
        alert("Publicado com sucesso!");
        document.getElementById('post-content').value = "";
        renderPosts();
        showTab('home', document.querySelector('nav i'));
    }

    function apagarPost(id) {
        if(confirm("Tens a certeza que queres apagar esta publica√ß√£o?")) {
            posts = posts.filter(p => p.id !== id);
            localStorage.setItem('cervantes_posts', JSON.stringify(posts));
            renderPosts();
        }
    }

    function renderPosts() {
        const feed = document.getElementById('global-feed');
        const myChannel = document.getElementById('my-posts-list');
        feed.innerHTML = "";
        myChannel.innerHTML = "";

        posts.forEach(p => {
            const html = `
                <div class="card">
                    <div class="post-manage">
                        <strong>@Tu</strong>
                        <span class="del-btn" onclick="apagarPost(${p.id})">Apagar</span>
                    </div>
                    <p>${p.content}</p>
                    <small style="color: #888;">${p.type.toUpperCase()} ‚Ä¢ ${p.date}</small>
                </div>
            `;
            feed.innerHTML += html;
            myChannel.innerHTML += html;
        });
    }

    window.onload = renderPosts;
</script>

</body>
</html>
